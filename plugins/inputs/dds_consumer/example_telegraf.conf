# Simple Telegraf Configuration for DDS Consumer Plugin
# 
# QUICK START:
# 1. Install RTI Connector: go run github.com/rticommunity/rticonnextdds-connector-go/cmd/download-libs@latest
# 2. Set library path: export DYLD_LIBRARY_PATH=$(pwd)/rticonnextdds-connector/lib/osx-arm64:$DYLD_LIBRARY_PATH
# 3. Build with DDS support: go build -tags dds ./cmd/telegraf
# 4. Run: ./telegraf --config plugins/inputs/dds_consumer/example_telegraf.conf
#
# This example works with RTI Shapes Demo or the included example_config.xml

[global_tags]
  environment = "development"

[agent]
  interval = "10s"
  round_interval = true
  metric_batch_size = 1
  metric_buffer_limit = 10000
  flush_interval = "10s"
  debug = true
  omit_hostname = false

###############################################################################
#                            OUTPUT PLUGINS                                  #
###############################################################################

# OUTPUT: Print metrics to console (good for testing)
[[outputs.file]]
  files = ["stdout"]
  data_format = "influx"

# OUTPUT: Save to InfluxDB (uncomment to use)
# [[outputs.influxdb]]
#   urls = ["http://localhost:8086"]
#   database = "dds_metrics"

###############################################################################
#                            INPUT PLUGINS                                   #
###############################################################################

# INPUT: DDS Consumer for Shape data (works with RTI Shapes Demo)
[[inputs.dds_consumer]]
  # Path to your DDS XML configuration file
  config_path = "plugins/inputs/dds_consumer/example_config.xml"
  
  # DDS Participant configuration from XML
  participant_config = "MyParticipantLibrary::Zero"
  
  # DDS DataReader configuration from XML  
  reader_config = "MySubscriber::MySquareReader"
  
  # Fields to use as metric tags (instead of fields)
  tag_keys = ["color"]
  
  # Name for the measurement
  name_override = "square"

# INPUT: DDS Consumer for Circle data (optional - shows multiple readers)
# [[inputs.dds_consumer]]
#   config_path = "example_config.xml"
#   participant_config = "MyParticipantLibrary::Zero"
#   reader_config = "MySubscriber::MyCircleReader"
#   tag_keys = ["color"]
#   name_override = "circle"